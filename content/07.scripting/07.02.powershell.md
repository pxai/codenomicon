## Powershell {#powershell}
This is the intro

### First, enable
In order to execute commands in the shell, check and then set
```
PS C:\Users\Administrador\Documents\powershell> Get-ExecutionPolicy
Restricted
PS C:\Users\Administrador\Documents\powershell> Set-ExecutionPolicy -ExecutionPolicy Unrestricted
```
### Executing

```shell
PS C:\> .\HelloWorld.ps1
PS C:\> c:\HelloWorld.ps1
PS C:\> c:\HelloWorld
PS C:\> & c:\HelloWorld.ps1
PS C:\> c:\HelloWorld.ps1
PS C:\> Invoke-Expression C:\HelloWorld.ps1
PS C:\> Invoke-Expression "C:\HelloWorld.ps1"
```

### Getting help
First, try this
```shell
PS C:\> update-help
```

Different ways of getting help
```
PS C:\> Get-Help Add-Computer
PS C:\> help dir -full
PS C:\> get-help *printer*
```

### Comments
```perl
# This is just a comment
# Behold the PowerShell Hello World
# Pello Xabier Altadill Izura
Write­Output "Hello World"
```

### Reading from console
```perl
# input.ps1
# Basic I/O, simple example of reading from console.
# When you read from console the type of data is string,
# so you need to cast to int if you need to make any arythmetic op.
# Pello Xabier Altadill Izura
$name = Read­Host "Write your name"
Write­Output "Your name is $name"
# Now we try to read two numbers
$a = Read­host "Write a number"
$b = Read­host "Write another number"
# Before we add them we have to cast them to int
$result = ([int]$a + [int]$b)
Write­Output "Result is : $result"
```

If you need to hide characters use -AsSecureString flag:
```shell
PS C:\> $pass= Read-Host -AsSecureString "Enter yout password"
here: ********
```

### Variables
```perl
# vars.ps1
# Shows the basic use of vars and basic types in PowerShell
# Pello Xabier Altadill Izura
$Number = 666

# Strings
$Name = "Angel"
$AnotherName = 'María'

# Booleans
$ThisIsWindows = TRUE
$ILikeMetro = FALSE
$Number = 5.55
$name = "Alberto"

# A very long string
$LongMessage = @"
Gods of war I call you
My sword is by my side
I seek a life of honor
Free from all false pride
"@

Write­Output $Name
Write­Output "Result: " $number
Write­Output "Expression result:" $($numero + 6)
#Write­Output $Numero.GetType()
```
result
```
PS C:\> C:\powershell\vars.ps1
Alberto
Result:
5,55
Expression result:
11,55
PS C:\>
```

Types:

| Type  | Description |
|-------|------------|
| [int] | 32 bit int |
| [long] | 64 bit int |
| [string] | Unicode string |
| [char] | 16 bit unicode character |
| [byte] |  unsigned 8 bit character |
| [bool] | boolean True/False |
| [decimal] | 128 bit decimal number |
| [double] | 64 bit floating point |
| [single] | 32 bit floating point |
| [xml] | XML object |
| [array] | array of values |
| [hashtable] | a hashtable |

Get the types
```perl
$variable.getType()
$variable.getType().FullName
```
Cast
```perl
$result = [int]$foo + [int] $var
```

### Arrays
```perl
# arrays.ps1
# shows the use of arrays  in PowerShell scripts
# Pello Xabier Altadill Izura
# we can define an array just like this
$numbers = 22,"test",80,110,143,­66,0,5
Write­Output $numbers[0]
$numbers[2] = 1024
Write­Output "All the array: $numbers"
# If you need to start with an empty array
$emptyArray = @()
Write­output "Array length is: " $emptyArray.Length
# Now is an array with just one element
$emptyArray = ,4
# to add elements to the array:
$emptyArray = $emptyArray+ 50
Write­Output "The array now: $emptyArray"
$heroes = @("Gandalf","Ned Stark","Conan")
$heroes = $heroes + "Haplo"
Write­Output "Best heroes ever: " $heroes
```

Output
```shell
PS C:\> C:\powershell\arrays.ps1
22
All the array: 22 test 1024 110 143 -66 0 5
Array length is:
0
The array now: 4 50
Best heroes ever:
Gandalf
Ned Stark
Conan
Haplo
PS C:\>
```

### Reading from console
```perl
```

### Reading from console
```perl
```

### Reading from console
```perl
```
